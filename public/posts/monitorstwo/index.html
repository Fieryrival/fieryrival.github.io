<!doctype html><html lang=en dir=auto data-theme=auto><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Abusing Cacti: From SQLi to Root on MonitorsTwo | Fieryrival's Blog</title><meta name=keywords content="linux,cacti,docker,suid"><meta name=description content="Easy rated linux box from hackthebox comprising of cacti, rce, and docker cve."><meta name=author content><link rel=canonical href=//localhost:1313/posts/monitorstwo/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.343cc480b9ffc8f04ccbe5e968ad674880cab773ec19905e93033065c1e7a804.css integrity="sha256-NDzEgLn/yPBMy+XpaK1nSIDKt3PsGZBekwMwZcHnqAQ=" rel="preload stylesheet" as=style><link rel=icon href=//localhost:1313/favicon.ico><link rel=icon type=image/png sizes=16x16 href=//localhost:1313/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=//localhost:1313/favicon-32x32.png><link rel=apple-touch-icon href=//localhost:1313/apple-touch-icon.png><link rel=mask-icon href=//localhost:1313/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=//localhost:1313/posts/monitorstwo/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51);color-scheme:dark}.list{background:var(--theme)}.toc{background:var(--entry)}}@media(prefers-color-scheme:light){.list::-webkit-scrollbar-thumb{border-color:var(--code-bg)}}</style></noscript><script>localStorage.getItem("pref-theme")==="dark"?document.querySelector("html").dataset.theme="dark":localStorage.getItem("pref-theme")==="light"?document.querySelector("html").dataset.theme="light":window.matchMedia("(prefers-color-scheme: dark)").matches?document.querySelector("html").dataset.theme="dark":document.querySelector("html").dataset.theme="light"</script><meta property="og:url" content="//localhost:1313/posts/monitorstwo/"><meta property="og:site_name" content="Fieryrival's Blog"><meta property="og:title" content="Abusing Cacti: From SQLi to Root on MonitorsTwo"><meta property="og:description" content="Easy rated linux box from hackthebox comprising of cacti, rce, and docker cve."><meta property="og:locale" content="en-us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-11-30T00:00:00+00:00"><meta property="article:modified_time" content="2025-11-30T00:00:00+00:00"><meta property="article:tag" content="Linux"><meta property="article:tag" content="Cacti"><meta property="article:tag" content="Docker"><meta property="article:tag" content="Suid"><meta property="og:image" content="//localhost:1313/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="//localhost:1313/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="Abusing Cacti: From SQLi to Root on MonitorsTwo"><meta name=twitter:description content="Easy rated linux box from hackthebox comprising of cacti, rce, and docker cve."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"//localhost:1313/posts/"},{"@type":"ListItem","position":2,"name":"Abusing Cacti: From SQLi to Root on MonitorsTwo","item":"//localhost:1313/posts/monitorstwo/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Abusing Cacti: From SQLi to Root on MonitorsTwo","name":"Abusing Cacti: From SQLi to Root on MonitorsTwo","description":"Easy rated linux box from hackthebox comprising of cacti, rce, and docker cve.","keywords":["linux","cacti","docker","suid"],"articleBody":"\nRecon Nmap PORT STATE SERVICE REASON VERSION 22/tcp open ssh syn-ack OpenSSH 8.2p1 Ubuntu 4ubuntu0.5 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 3072 48:ad:d5:b8:3a:9f:bc:be:f7:e8:20:1e:f6:bf:de:ae (RSA) | ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQC82vTuN1hMqiqUfN+Lwih4g8rSJjaMjDQdhfdT8vEQ67urtQIyPszlNtkCDn6MNcBfibD/7Zz4r8lr1iNe/Afk6LJqTt3OWewzS2a1TpCrEbvoileYAl/Feya5PfbZ8mv77+MWEA+kT0pAw1xW9bpkhYCGkJQm9OYdcsEEg1i+kQ/ng3+GaFrGJjxqYaW1LXyXN1f7j9xG2f27rKEZoRO/9HOH9Y+5ru184QQXjW/ir+lEJ7xTwQA5U1GOW1m/AgpHIfI5j9aDfT/r4QMe+au+2yPotnOGBBJBz3ef+fQzj/Cq7OGRR96ZBfJ3i00B/Waw/RI19qd7+ybNXF/gBzptEYXujySQZSu92Dwi23itxJBolE6hpQ2uYVA8VBlF0KXESt3ZJVWSAsU3oguNCXtY7krjqPe6BZRy+lrbeska1bIGPZrqLEgptpKhz14UaOcH9/vpMYFdSKr24aMXvZBDK1GJg50yihZx8I9I367z0my8E89+TnjGFY2QTzxmbmU= | 256 b7:89:6c:0b:20:ed:49:b2:c1:86:7c:29:92:74:1c:1f (ECDSA) | ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBH2y17GUe6keBxOcBGNkWsliFwTRwUtQB3NXEhTAFLziGDfCgBV7B9Hp6GQMPGQXqMk7nnveA8vUz0D7ug5n04A= | 256 18:cd:9d:08:a6:21:a8:b8:b6:f7:9f:8d:40:51:54:fb (ED25519) |_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIKfXa+OM5/utlol5mJajysEsV4zb/L0BJ1lKxMPadPvR 80/tcp open http syn-ack nginx 1.18.0 (Ubuntu) |_http-title: Login to Cacti | http-methods: |_ Supported Methods: GET HEAD POST OPTIONS |_http-favicon: Unknown favicon MD5: 4F12CCCD3C42A4A478F067337FE92794 |_http-server-header: nginx/1.18.0 (Ubuntu) Website at TCP 80 The website welcomed us with a logic screen for Cacti. Cacti is a network monitoring and graphing software designed to help IT professionals and administrators monitor and manage network performance and usage. It is an open-source tool commonly used to collect, store, and visualize data about network devices, such as routers, switches, and servers.\nThe first thing we did was check its version and look for existing vulnerabilities. It was found to be vulnerable to CVE-2022-46169, a Remote Code Execution vulnerability.\nThe vulnerability was a combination of authentication bypass and remote code execution. Here the file remote_agent.php could be accessed without authentication. The public exploit was available on exploit-db which though did not work directly gave us a better understanding of the exploit. The first part of it was the “X-Forwarded-For header: 127.0.0.1” which bypassed the authorization check of the server. Also, an authorized user can trigger different actions. Command injection can be achieved by injecting code into the poller_id param and host_id and local_data_id are easily brute-forced. While doing the box I tried different PoCs even metasploit but none gave a shell. The Metasploit one did give the two brute-forced parameters. We can go ahead and craft our own curl request to confirm the vulnerability and gain a foothold.\nSo, I opened port 4444 on the local machine to listen for connections and injected a curl command to confirm the command execution. And Voila we got a hit back. Now we can get into the box.\nUpgraded to a stable shell with script binary. It’s very rare to not find Python on boxes, the reason might be that it was a docker container.\nGetting root on docker While looking at the root directory we got to know it’s a docker container with an interesting file entrypoint.sh. Also /sbin/capsh had setuid bit set and could be used to get root in the box. It was quite an interesting experience here since normally on dockers, the next step is to escape, SO while solving the box, I tried each and every possibility. Also, I did find the MySQL hashes for user Marcus but not giving enough time to crack made me go towards docker breakout.\nbash-5.1$ ls -la /sbin/capsh -rwsr-xr-x 1 root root 30872 Oct 14 2020 /sbin/capsh Shell as Marcus Well, I had to finally revert to other methods since the docker breakout did not work. Though I read a lot and got to know almost all the techniques. I got to know that the hashes were crackable given some time.\nWe could crack Marcus’ password and could get SSH access into the machine. The initial prompt that caught my attention was that we had some mail. Before looking at it I tried if we could run any commands with the privilege of another user or root.\nPrivilege Escalation The mail was from administrator@monitorstwo.htb citing three vulnerabilities. It was now a matter of guessing which one could lead to privilege escalation. I checked for internal services and there was not much to look at.\nFrom: administrator@monitorstwo.htb To: all@monitorstwo.htb Subject: Security Bulletin - Three Vulnerabilities to be Aware Of Dear all, We would like to bring to your attention three vulnerabilities that have been recently discovered and should be addressed as soon as possible. CVE-2021-33033: This vulnerability affects the Linux kernel before 5.11.14 and is related to the CIPSO and CALIPSO refcounting for the DOI definitions. Attackers can exploit this use-after-free issue to write arbitrary values. Please update your kernel to version 5.11.14 or later to address this vulnerability. CVE-2020-25706: This cross-site scripting (XSS) vulnerability affects Cacti 1.2.13 and occurs due to improper escaping of error messages during template import previews in the xml_path field. This could allow an attacker to inject malicious code into the webpage, potentially resulting in the theft of sensitive data or session hijacking. Please upgrade to Cacti version 1.2.14 or later to address this vulnerability. CVE-2021-41091: This vulnerability affects Moby, an open-source project created by Docker for software containerization. Attackers could exploit this vulnerability by traversing directory contents and executing programs on the data directory with insufficiently restricted permissions. The bug has been fixed in Moby (Docker Engine) version 20.10.9, and users should update to this version as soon as possible. Please note that running containers should be stopped and restarted for the permissions to be fixed. We encourage you to take the necessary steps to address these vulnerabilities promptly to avoid any potential security breaches. If you have any questions or concerns, please do not hesitate to contact our IT department. Best regards, Administrator CISO Monitor Two Security Team For CVE-2021-33033, It seemed like a kernel exploit which is quite rare to find in HTB so I moved on to the second and third. I certainly would’ve gone back to it if my initial choice didn’t work. The second CVE-2020-25706 was XSS vulnerability which could’ve been a go-to option but since there weren’t any other websites running and also XSS could not lead to privilege escalation directly. The third CVE-2021-41091 was a docker vulnerability which could be our target vulnerability. I checked the docker version and yes, it was vulnerable.\nDocker version 20.10.5 \u003c 20.10.9 was vulnerable to this exploit but an interesting thing here was when the box was released there weren’t any public exploits available but only the description. Now after having known the explanation it does seem obvious but while solving the box It was also a bit confusing. It says that due to insufficient permissions, the files of the docker can be accessed from the host inside the /var/lib/docker directory and unprivileged users can execute setuid bit binaries inside the container by traversing and getting root inside the host.\nmarcus@monitorstwo:~$ docker --version Docker version 20.10.5+dfsg1, build 55c4c88 So, I put bash setuid bit binary inside the /dev/shm directory.\nroot@50bca5e748b0:/dev/shm# ls -la total 1208 drwxrwxrwt 2 root root 60 Sep 1 08:56 . drwxr-xr-x 5 root root 340 Sep 1 05:11 .. -rwsr-sr-x 1 root root 1234376 Sep 1 08:56 noob We can see mount details of docker from the file /proc/mounts which shows overlay directories that could be accessed from the host.\nThe official docker documentation explains overlayFS as -\nOverlayFS layers two directories on a single Linux host and presents them as a single directory. These directories are called layers and the unification process is referred to as a union mount. OverlayFS refers to the lower directory as lowerdir and the upper directory as upperdir. The unified view is exposed through its own directory called merged.\nThe upperdir location could be accessed from the host and it showed a few folders from the root directory of the docker container. I had not read about the merge or else it could’ve been even easier to get access to the whole file system of the directory. I managed to put a file to check if my changes were seen on the host.\nroot@50bca5e748b0:/proc# strings mounts overlay / overlay rw,relatime,lowerdir=/var/lib/docker/overlay2/l/4Z77R4WYM6X4BLW7GXAJOAA4SJ:/var/lib/docker/overlay2/l/Z4RNRWTZKMXNQJVSRJE4P2JYHH:/var/lib/docker/overlay2/l/CXAW6LQU6QOKNSSNURRN2X4JEH:/var/lib/docker/overlay2/l/YWNFANZGTHCUIML4WUIJ5XNBLJ:/var/lib/docker/overlay2/l/JWCZSRNDZSQFHPN75LVFZ7HI2O:/var/lib/docker/overlay2/l/DGNCSOTM6KEIXH4KZVTVQU2KC3:/var/lib/docker/overlay2/l/QHFZCDCLZ4G4OM2FLV6Y2O6WC6:/var/lib/docker/overlay2/l/K5DOR3JDWEJL62G4CATP62ONTO:/var/lib/docker/overlay2/l/FGHBJKAFBSAPJNSTCR6PFSQ7ER:/var/lib/docker/overlay2/l/PDO4KALS2ULFY6MGW73U6QRWSS:/var/lib/docker/overlay2/l/MGUNUZVTUDFYIRPLY5MR7KQ233:/var/lib/docker/overlay2/l/VNOOF2V3SPZEXZHUKR62IQBVM5:/var/lib/docker/overlay2/l/CDCPIX5CJTQCR4VYUUTK22RT7W:/var/lib/docker/overlay2/l/G4B75MXO7LXFSK4GCWDNLV6SAQ:/var/lib/docker/overlay2/l/FRHKWDF3YAXQ3LBLHIQGVNHGLF:/var/lib/docker/overlay2/l/ZDJ6SWVJF6EMHTTO3AHC3FH3LD:/var/lib/docker/overlay2/l/W2EMLMTMXN7ODPSLB2FTQFLWA3:/var/lib/docker/overlay2/l/QRABR2TMBNL577HC7DO7H2JRN2:/var/lib/docker/overlay2/l/7IGVGYP6R7SE3WFLYC3LOBPO4Z:/var/lib/docker/overlay2/l/67QPWIAFA4NXFNM6RN43EHUJ6Q,upperdir=/var/lib/docker/overlay2/c41d5854e43bd996e128d647cb526b73d04c9ad6325201c85f73fdba372cb2f1/diff,workdir=/var/lib/docker/overlay2/c41d5854e43bd996e128d647cb526b73d04c9ad6325201c85f73fdba372cb2f1/work,xino=off 0 0 proc /proc proc rw,nosuid,nodev,noexec,relatime 0 0 tmpfs /dev tmpfs rw,nosuid,size=65536k,mode=755 0 0 devpts /dev/pts devpts rw,nosuid,noexec,relatime,gid=5,mode=620,ptmxmode=666 0 0 sysfs /sys sysfs ro,nosuid,nodev,noexec,relatime 0 0 tmpfs /sys/fs/cgroup tmpfs rw,nosuid,nodev,noexec,relatime,mode=755 0 0 cgroup /sys/fs/cgroup/systemd cgroup ro,nosuid,nodev,noexec,relatime,xattr,name=systemd 0 0 cgroup /sys/fs/cgroup/hugetlb cgroup ro,nosuid,nodev,noexec,relatime,hugetlb 0 0 cgroup /sys/fs/cgroup/cpu,cpuacct cgroup ro,nosuid,nodev,noexec,relatime,cpu,cpuacct 0 0 cgroup /sys/fs/cgroup/memory cgroup ro,nosuid,nodev,noexec,relatime,memory 0 0 cgroup /sys/fs/cgroup/net_cls,net_prio cgroup ro,nosuid,nodev,noexec,relatime,net_cls,net_prio 0 0 cgroup /sys/fs/cgroup/pids cgroup ro,nosuid,nodev,noexec,relatime,pids 0 0 cgroup /sys/fs/cgroup/freezer cgroup ro,nosuid,nodev,noexec,relatime,freezer 0 0 cgroup /sys/fs/cgroup/cpuset cgroup ro,nosuid,nodev,noexec,relatime,cpuset 0 0 cgroup /sys/fs/cgroup/devices cgroup ro,nosuid,nodev,noexec,relatime,devices 0 0 cgroup /sys/fs/cgroup/perf_event cgroup ro,nosuid,nodev,noexec,relatime,perf_event 0 0 cgroup /sys/fs/cgroup/rdma cgroup ro,nosuid,nodev,noexec,relatime,rdma 0 0 cgroup /sys/fs/cgroup/blkio cgroup ro,nosuid,nodev,noexec,relatime,blkio 0 0 mqueue /dev/mqueue mqueue rw,nosuid,nodev,noexec,relatime 0 0 /dev/sda2 /entrypoint.sh ext4 rw,relatime 0 0 /dev/sda2 /etc/resolv.conf ext4 rw,relatime 0 0 /dev/sda2 /etc/hostname ext4 rw,relatime 0 0 /dev/sda2 /etc/hosts ext4 rw,relatime 0 0 shm /dev/shm tmpfs rw,nosuid,nodev,noexec,relatime,size=65536k 0 0 proc /proc/bus proc ro,nosuid,nodev,noexec,relatime 0 0 proc /proc/fs proc ro,nosuid,nodev,noexec,relatime 0 0 proc /proc/irq proc ro,nosuid,nodev,noexec,relatime 0 0 proc /proc/sys proc ro,nosuid,nodev,noexec,relatime 0 0 proc /proc/sysrq-trigger proc ro,nosuid,nodev,noexec,relatime 0 0 tmpfs /proc/acpi tmpfs ro,relatime 0 0 tmpfs /proc/kcore tmpfs rw,nosuid,size=65536k,mode=755 0 0 tmpfs /proc/keys tmpfs rw,nosuid,size=65536k,mode=755 0 0 tmpfs /proc/timer_list tmpfs rw,nosuid,size=65536k,mode=755 0 0 tmpfs /proc/sched_debug tmpfs rw,nosuid,size=65536k,mode=755 0 0 tmpfs /proc/scsi tmpfs ro,relatime 0 0 tmpfs /sys/firmware tmpfs ro,relatime 0 0 I created a file test inside the docker and it could be seen from the host machine. The rest steps are quite simple putting the bash SUID binary inside the temporary directory and getting root in the host machine.\nnoob-5.1# ls -la total 28 drwx-----x 5 root root 4096 Sep 1 05:11 . drwx-----x 37 root root 4096 Sep 1 05:11 .. drwxr-xr-x 7 root root 4096 Sep 1 09:24 diff -rw-r--r-- 1 root root 26 Mar 21 10:49 link -rw-r--r-- 1 root root 579 Mar 21 10:49 lower drwxr-xr-x 1 root root 4096 Sep 1 09:24 merged drwx------ 3 root root 4096 Sep 1 05:11 work noob-5.1# pwd /var/lib/docker/overlay2/c41d5854e43bd996e128d647cb526b73d04c9ad6325201c85f73fdba372cb2f1 noob-5.1# ls -la merged total 152 drwxr-xr-x 1 root root 4096 Sep 1 09:24 . drwx-----x 5 root root 4096 Sep 1 05:11 .. drwxr-xr-x 1 root root 4096 Mar 22 13:21 bin drwxr-xr-x 2 root root 4096 Mar 22 13:21 boot drwxr-xr-x 1 root root 4096 Mar 21 10:49 dev -rwxr-xr-x 1 root root 0 Mar 21 10:49 .dockerenv -rwxr-xr-x 1 root root 0 Jan 5 2023 entrypoint.sh drwxr-xr-x 1 root root 4096 Mar 21 10:49 etc drwxr-xr-x 2 root root 4096 Mar 22 13:21 home drwxr-xr-x 1 root root 4096 Nov 15 2022 lib drwxr-xr-x 2 root root 4096 Mar 22 13:21 lib64 drwxr-xr-x 2 root root 4096 Mar 22 13:21 media drwxr-xr-x 2 root root 4096 Mar 22 13:21 mnt drwxr-xr-x 2 root root 4096 Mar 22 13:21 opt drwxr-xr-x 2 root root 4096 Mar 22 13:21 proc drwx------ 1 root root 4096 Mar 21 10:50 root drwxr-xr-x 1 root root 4096 Nov 15 2022 run drwxr-xr-x 1 root root 4096 Jan 9 2023 sbin drwxr-xr-x 2 root root 4096 Mar 22 13:21 srv drwxr-xr-x 2 root root 4096 Mar 22 13:21 sys drwxrwxrwt 1 root root 57344 Sep 1 09:37 tmp drwxr-xr-x 1 root root 4096 Nov 14 2022 usr drwxr-xr-x 1 root root 4096 Nov 15 2022 var noob-5.1# ls -la diff total 96 drwxr-xr-x 7 root root 4096 Sep 1 09:24 . drwx-----x 5 root root 4096 Sep 1 05:11 .. drwxr-xr-x 2 root root 4096 Mar 22 13:21 bin drwx------ 2 root root 4096 Mar 21 10:50 root drwxr-xr-x 3 root root 4096 Nov 15 2022 run drwxrwxrwt 2 root root 57344 Sep 1 09:37 tmp drwxr-xr-x 4 root root 4096 Nov 15 2022 var References https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-41091\nhttps://nvd.nist.gov/vuln/detail/CVE-2022-46169\n","wordCount":"1837","inLanguage":"en","image":"//localhost:1313/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E","datePublished":"2025-11-30T00:00:00Z","dateModified":"2025-11-30T00:00:00Z","mainEntityOfPage":{"@type":"WebPage","@id":"//localhost:1313/posts/monitorstwo/"},"publisher":{"@type":"Organization","name":"Fieryrival's Blog","logo":{"@type":"ImageObject","url":"//localhost:1313/favicon.ico"}}}</script></head><body id=top><header class=header><nav class=nav><div class=logo><a href=//localhost:1313/ accesskey=h title="Home (Alt + H)"><img src=//localhost:1313/apple-touch-icon_hu_ca5ae87867264747.png alt aria-label=logo height=35>Home</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=//localhost:1313/about/ title="About Me"><span>About</span></a></li><li><a href=//localhost:1313/tags/ title=tags><span>tags</span></a></li><li><a href=//localhost:1313/posts/ title=posts><span>posts</span></a></li><li><a href=//localhost:1313/ title><span></span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=//localhost:1313/>Home</a>&nbsp;»&nbsp;<a href=//localhost:1313/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">Abusing Cacti: From SQLi to Root on MonitorsTwo</h1><div class=post-meta><span title='2025-11-30 00:00:00 +0000 UTC'>November 30, 2025</span>&nbsp;·&nbsp;<span>9 min</span>&nbsp;·&nbsp;<span>1837 words</span></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#recon>Recon</a><ul><li><a href=#nmap>Nmap</a></li><li><a href=#website-at-tcp-80>Website at TCP 80</a></li><li><a href=#getting-root-on-docker>Getting root on docker</a></li><li><a href=#shell-as-marcus>Shell as Marcus</a></li><li><a href=#privilege-escalation>Privilege Escalation</a></li><li><a href=#references>References</a></li></ul></li></ul></nav></div></details></div><div class=post-content><p><img alt=MonitorsTwo.png loading=lazy src=/posts/monitorstwo/MonitorsTwo%20f8837d236f27423191390fe94e30a78b/MonitorsTwo.png></p><h2 id=recon>Recon<a hidden class=anchor aria-hidden=true href=#recon>#</a></h2><h3 id=nmap>Nmap<a hidden class=anchor aria-hidden=true href=#nmap>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>PORT      STATE    SERVICE          REASON      VERSION
</span></span><span class=line><span class=cl>22/tcp    open     ssh              syn-ack     OpenSSH 8.2p1 Ubuntu 4ubuntu0.5 <span class=o>(</span>Ubuntu Linux<span class=p>;</span> protocol 2.0<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span> ssh-hostkey: 
</span></span><span class=line><span class=cl><span class=p>|</span>   <span class=m>3072</span> 48:ad:d5:b8:3a:9f:bc:be:f7:e8:20:1e:f6:bf:de:ae <span class=o>(</span>RSA<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span> ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQC82vTuN1hMqiqUfN+Lwih4g8rSJjaMjDQdhfdT8vEQ67urtQIyPszlNtkCDn6MNcBfibD/7Zz4r8lr1iNe/Afk6LJqTt3OWewzS2a1TpCrEbvoileYAl/Feya5PfbZ8mv77+MWEA+kT0pAw1xW9bpkhYCGkJQm9OYdcsEEg1i+kQ/ng3+GaFrGJjxqYaW1LXyXN1f7j9xG2f27rKEZoRO/9HOH9Y+5ru184QQXjW/ir+lEJ7xTwQA5U1GOW1m/AgpHIfI5j9aDfT/r4QMe+au+2yPotnOGBBJBz3ef+fQzj/Cq7OGRR96ZBfJ3i00B/Waw/RI19qd7+ybNXF/gBzptEYXujySQZSu92Dwi23itxJBolE6hpQ2uYVA8VBlF0KXESt3ZJVWSAsU3oguNCXtY7krjqPe6BZRy+lrbeska1bIGPZrqLEgptpKhz14UaOcH9/vpMYFdSKr24aMXvZBDK1GJg50yihZx8I9I367z0my8E89+TnjGFY2QTzxmbmU<span class=o>=</span>
</span></span><span class=line><span class=cl><span class=p>|</span>   <span class=m>256</span> b7:89:6c:0b:20:ed:49:b2:c1:86:7c:29:92:74:1c:1f <span class=o>(</span>ECDSA<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span> ecdsa-sha2-nistp256 <span class=nv>AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBH2y17GUe6keBxOcBGNkWsliFwTRwUtQB3NXEhTAFLziGDfCgBV7B9Hp6GQMPGQXqMk7nnveA8vUz0D7ug5n04A</span><span class=o>=</span>
</span></span><span class=line><span class=cl><span class=p>|</span>   <span class=m>256</span> 18:cd:9d:08:a6:21:a8:b8:b6:f7:9f:8d:40:51:54:fb <span class=o>(</span>ED25519<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span>_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIKfXa+OM5/utlol5mJajysEsV4zb/L0BJ1lKxMPadPvR
</span></span><span class=line><span class=cl>80/tcp    open     http             syn-ack     nginx 1.18.0 <span class=o>(</span>Ubuntu<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span>_http-title: Login to Cacti
</span></span><span class=line><span class=cl><span class=p>|</span> http-methods: 
</span></span><span class=line><span class=cl><span class=p>|</span>_  Supported Methods: GET HEAD POST OPTIONS
</span></span><span class=line><span class=cl><span class=p>|</span>_http-favicon: Unknown favicon MD5: 4F12CCCD3C42A4A478F067337FE92794
</span></span><span class=line><span class=cl><span class=p>|</span>_http-server-header: nginx/1.18.0 <span class=o>(</span>Ubuntu<span class=o>)</span>
</span></span></code></pre></div><h3 id=website-at-tcp-80>Website at TCP 80<a hidden class=anchor aria-hidden=true href=#website-at-tcp-80>#</a></h3><p><img alt="Screenshot from 2023-09-01 12-28-37.png" loading=lazy src=/posts/monitorstwo/MonitorsTwo%20f8837d236f27423191390fe94e30a78b/Screenshot_from_2023-09-01_12-28-37.png></p><p>The website welcomed us with a logic screen for Cacti. Cacti is a network monitoring and graphing software designed to help IT professionals and administrators monitor and manage network performance and usage. It is an open-source tool commonly used to collect, store, and visualize data about network devices, such as routers, switches, and servers.</p><p>The first thing we did was check its version and look for existing vulnerabilities. It was found to be vulnerable to <code>CVE-2022-46169</code>, a Remote Code Execution vulnerability.</p><p>The vulnerability was a combination of authentication bypass and remote code execution. Here the file <code>remote_agent.php</code> could be accessed without authentication. The public exploit was available on exploit-db which though did not work directly gave us a better understanding of the exploit. The first part of it was the “X-Forwarded-For header: 127.0.0.1” which bypassed the authorization check of the server. Also, an authorized user can trigger different actions. Command injection can be achieved by injecting code into the poller_id param and host_id and local_data_id are easily brute-forced. While doing the box I tried different PoCs even metasploit but none gave a shell. The Metasploit one did give the two brute-forced parameters. We can go ahead and craft our own curl request to confirm the vulnerability and gain a foothold.</p><p><img alt=Untitled loading=lazy src=/posts/monitorstwo/MonitorsTwo%20f8837d236f27423191390fe94e30a78b/Untitled.png></p><p><img alt=Untitled loading=lazy src=/posts/monitorstwo/MonitorsTwo%20f8837d236f27423191390fe94e30a78b/Untitled%201.png></p><p>So, I opened port 4444 on the local machine to listen for connections and injected a curl command to confirm the command execution. And Voila we got a hit back. Now we can get into the box.</p><p><img alt=Untitled loading=lazy src=/posts/monitorstwo/MonitorsTwo%20f8837d236f27423191390fe94e30a78b/Untitled%202.png></p><p><img alt=Untitled loading=lazy src=/posts/monitorstwo/MonitorsTwo%20f8837d236f27423191390fe94e30a78b/Untitled%203.png></p><p>Upgraded to a stable shell with script binary. It&rsquo;s very rare to not find Python on boxes, the reason might be that it was a docker container.</p><p><img alt=Untitled loading=lazy src=/posts/monitorstwo/MonitorsTwo%20f8837d236f27423191390fe94e30a78b/Untitled%204.png></p><h3 id=getting-root-on-docker>Getting root on docker<a hidden class=anchor aria-hidden=true href=#getting-root-on-docker>#</a></h3><p>While looking at the root directory we got to know it&rsquo;s a docker container with an interesting file <code>entrypoint.sh</code>. Also <code>/sbin/capsh</code> had setuid bit set and could be used to get root in the box. It was quite an interesting experience here since normally on dockers, the next step is to escape, SO while solving the box, I tried each and every possibility. Also, I did find the MySQL hashes for user Marcus but not giving enough time to crack made me go towards docker breakout.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-jsx data-lang=jsx><span class=line><span class=cl><span class=nx>bash</span><span class=o>-</span><span class=mf>5.1</span><span class=nx>$</span> <span class=nx>ls</span> <span class=o>-</span><span class=nx>la</span> <span class=o>/</span><span class=nx>sbin</span><span class=o>/</span><span class=nx>capsh</span>
</span></span><span class=line><span class=cl><span class=o>-</span><span class=nx>rwsr</span><span class=o>-</span><span class=nx>xr</span><span class=o>-</span><span class=nx>x</span> <span class=mi>1</span> <span class=nx>root</span> <span class=nx>root</span> <span class=mi>30872</span> <span class=nx>Oct</span> <span class=mi>14</span>  <span class=mi>2020</span> <span class=o>/</span><span class=nx>sbin</span><span class=o>/</span><span class=nx>capsh</span>
</span></span></code></pre></div><p><img alt=Untitled loading=lazy src=/posts/monitorstwo/MonitorsTwo%20f8837d236f27423191390fe94e30a78b/Untitled%205.png></p><h3 id=shell-as-marcus>Shell as Marcus<a hidden class=anchor aria-hidden=true href=#shell-as-marcus>#</a></h3><p><img alt=Untitled loading=lazy src=/posts/monitorstwo/MonitorsTwo%20f8837d236f27423191390fe94e30a78b/Untitled%206.png></p><p><img alt=Untitled loading=lazy src=/posts/monitorstwo/MonitorsTwo%20f8837d236f27423191390fe94e30a78b/Untitled%207.png></p><p>Well, I had to finally revert to other methods since the docker breakout did not work. Though I read a lot and got to know almost all the techniques. I got to know that the hashes were crackable given some time.</p><p>We could crack Marcus’ password and could get SSH access into the machine. The initial prompt that caught my attention was that we had some mail. Before looking at it I tried if we could run any commands with the privilege of another user or root.</p><p><img alt=Untitled loading=lazy src=/posts/monitorstwo/MonitorsTwo%20f8837d236f27423191390fe94e30a78b/Untitled%208.png></p><h3 id=privilege-escalation>Privilege Escalation<a hidden class=anchor aria-hidden=true href=#privilege-escalation>#</a></h3><p>The mail was from <code>administrator@monitorstwo.htb</code> citing three vulnerabilities. It was now a matter of guessing which one could lead to privilege escalation. I checked for internal services and there was not much to look at.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>From: administrator@monitorstwo.htb
</span></span><span class=line><span class=cl>To: all@monitorstwo.htb
</span></span><span class=line><span class=cl>Subject: Security Bulletin - Three Vulnerabilities to be Aware Of
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Dear all,
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>We would like to bring to your attention three vulnerabilities that have been recently discovered and should be addressed as soon as possible.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>CVE-2021-33033: This vulnerability affects the Linux kernel before 5.11.14 and is related to the CIPSO and CALIPSO refcounting <span class=k>for</span> the DOI definitions. Attackers can exploit this use-after-free issue to write arbitrary values. Please update your kernel to version 5.11.14 or later to address this vulnerability.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>CVE-2020-25706: This cross-site scripting <span class=o>(</span>XSS<span class=o>)</span> vulnerability affects Cacti 1.2.13 and occurs due to improper escaping of error messages during template import previews in the xml_path field. This could allow an attacker to inject malicious code into the webpage, potentially resulting in the theft of sensitive data or session hijacking. Please upgrade to Cacti version 1.2.14 or later to address this vulnerability.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>CVE-2021-41091: This vulnerability affects Moby, an open-source project created by Docker <span class=k>for</span> software containerization. Attackers could exploit this vulnerability by traversing directory contents and executing programs on the data directory with insufficiently restricted permissions. The bug has been fixed in Moby <span class=o>(</span>Docker Engine<span class=o>)</span> version 20.10.9, and users should update to this version as soon as possible. Please note that running containers should be stopped and restarted <span class=k>for</span> the permissions to be fixed.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>We encourage you to take the necessary steps to address these vulnerabilities promptly to avoid any potential security breaches. If you have any questions or concerns, please <span class=k>do</span> not hesitate to contact our IT department.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Best regards,
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Administrator
</span></span><span class=line><span class=cl>CISO
</span></span><span class=line><span class=cl>Monitor Two
</span></span><span class=line><span class=cl>Security Team
</span></span></code></pre></div><p>For CVE-2021-33033, It seemed like a kernel exploit which is quite rare to find in HTB so I moved on to the second and third. I certainly would’ve gone back to it if my initial choice didn&rsquo;t work. The second CVE-2020-25706 was XSS vulnerability which could’ve been a go-to option but since there weren&rsquo;t any other websites running and also XSS could not lead to privilege escalation directly. The third CVE-2021-41091 was a docker vulnerability which could be our target vulnerability. I checked the docker version and yes, it was vulnerable.</p><p>Docker version 20.10.5 &lt; 20.10.9 was vulnerable to this exploit but an interesting thing here was when the box was released there weren&rsquo;t any public exploits available but only the description. Now after having known the explanation it does seem obvious but while solving the box It was also a bit confusing. It says that due to insufficient permissions, the files of the docker can be accessed from the host inside the <code>/var/lib/docker</code> directory and unprivileged users can execute setuid bit binaries inside the container by traversing and getting root inside the host.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>marcus@monitorstwo:~$ docker --version
</span></span><span class=line><span class=cl>Docker version 20.10.5+dfsg1, build 55c4c88
</span></span></code></pre></div><p>So, I put bash setuid bit binary inside the <code>/dev/shm</code> directory.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>root@50bca5e748b0:/dev/shm# ls -la
</span></span><span class=line><span class=cl>total <span class=m>1208</span>
</span></span><span class=line><span class=cl>drwxrwxrwt <span class=m>2</span> root root      <span class=m>60</span> Sep  <span class=m>1</span> 08:56 .
</span></span><span class=line><span class=cl>drwxr-xr-x <span class=m>5</span> root root     <span class=m>340</span> Sep  <span class=m>1</span> 05:11 ..
</span></span><span class=line><span class=cl>-rwsr-sr-x <span class=m>1</span> root root <span class=m>1234376</span> Sep  <span class=m>1</span> 08:56 noob
</span></span></code></pre></div><p>We can see mount details of docker from the file /proc/mounts which shows overlay directories that could be accessed from the host.</p><p>The official docker documentation explains overlayFS as -</p><p>OverlayFS layers two directories on a single Linux host and presents them as a single directory. These directories are called <em>layers</em> and the unification process is referred to as a <em>union mount</em>. OverlayFS refers to the lower directory as <code>lowerdir</code> and the upper directory as <code>upperdir</code>. The unified view is exposed through its own directory called <code>merged</code>.</p><p>The upperdir location could be accessed from the host and it showed a few folders from the root directory of the docker container. I had not read about the merge or else it could’ve been even easier to get access to the whole file system of the directory. I managed to put a file to check if my changes were seen on the host.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>root@50bca5e748b0:/proc# strings mounts
</span></span><span class=line><span class=cl>overlay / overlay rw,relatime,lowerdir<span class=o>=</span>/var/lib/docker/overlay2/l/4Z77R4WYM6X4BLW7GXAJOAA4SJ:/var/lib/docker/overlay2/l/Z4RNRWTZKMXNQJVSRJE4P2JYHH:/var/lib/docker/overlay2/l/CXAW6LQU6QOKNSSNURRN2X4JEH:/var/lib/docker/overlay2/l/YWNFANZGTHCUIML4WUIJ5XNBLJ:/var/lib/docker/overlay2/l/JWCZSRNDZSQFHPN75LVFZ7HI2O:/var/lib/docker/overlay2/l/DGNCSOTM6KEIXH4KZVTVQU2KC3:/var/lib/docker/overlay2/l/QHFZCDCLZ4G4OM2FLV6Y2O6WC6:/var/lib/docker/overlay2/l/K5DOR3JDWEJL62G4CATP62ONTO:/var/lib/docker/overlay2/l/FGHBJKAFBSAPJNSTCR6PFSQ7ER:/var/lib/docker/overlay2/l/PDO4KALS2ULFY6MGW73U6QRWSS:/var/lib/docker/overlay2/l/MGUNUZVTUDFYIRPLY5MR7KQ233:/var/lib/docker/overlay2/l/VNOOF2V3SPZEXZHUKR62IQBVM5:/var/lib/docker/overlay2/l/CDCPIX5CJTQCR4VYUUTK22RT7W:/var/lib/docker/overlay2/l/G4B75MXO7LXFSK4GCWDNLV6SAQ:/var/lib/docker/overlay2/l/FRHKWDF3YAXQ3LBLHIQGVNHGLF:/var/lib/docker/overlay2/l/ZDJ6SWVJF6EMHTTO3AHC3FH3LD:/var/lib/docker/overlay2/l/W2EMLMTMXN7ODPSLB2FTQFLWA3:/var/lib/docker/overlay2/l/QRABR2TMBNL577HC7DO7H2JRN2:/var/lib/docker/overlay2/l/7IGVGYP6R7SE3WFLYC3LOBPO4Z:/var/lib/docker/overlay2/l/67QPWIAFA4NXFNM6RN43EHUJ6Q,upperdir<span class=o>=</span>/var/lib/docker/overlay2/c41d5854e43bd996e128d647cb526b73d04c9ad6325201c85f73fdba372cb2f1/diff,workdir<span class=o>=</span>/var/lib/docker/overlay2/c41d5854e43bd996e128d647cb526b73d04c9ad6325201c85f73fdba372cb2f1/work,xino<span class=o>=</span>off <span class=m>0</span> <span class=m>0</span>
</span></span><span class=line><span class=cl>proc /proc proc rw,nosuid,nodev,noexec,relatime <span class=m>0</span> <span class=m>0</span>
</span></span><span class=line><span class=cl>tmpfs /dev tmpfs rw,nosuid,size<span class=o>=</span>65536k,mode<span class=o>=</span><span class=m>755</span> <span class=m>0</span> <span class=m>0</span>
</span></span><span class=line><span class=cl>devpts /dev/pts devpts rw,nosuid,noexec,relatime,gid<span class=o>=</span>5,mode<span class=o>=</span>620,ptmxmode<span class=o>=</span><span class=m>666</span> <span class=m>0</span> <span class=m>0</span>
</span></span><span class=line><span class=cl>sysfs /sys sysfs ro,nosuid,nodev,noexec,relatime <span class=m>0</span> <span class=m>0</span>
</span></span><span class=line><span class=cl>tmpfs /sys/fs/cgroup tmpfs rw,nosuid,nodev,noexec,relatime,mode<span class=o>=</span><span class=m>755</span> <span class=m>0</span> <span class=m>0</span>
</span></span><span class=line><span class=cl>cgroup /sys/fs/cgroup/systemd cgroup ro,nosuid,nodev,noexec,relatime,xattr,name<span class=o>=</span>systemd <span class=m>0</span> <span class=m>0</span>
</span></span><span class=line><span class=cl>cgroup /sys/fs/cgroup/hugetlb cgroup ro,nosuid,nodev,noexec,relatime,hugetlb <span class=m>0</span> <span class=m>0</span>
</span></span><span class=line><span class=cl>cgroup /sys/fs/cgroup/cpu,cpuacct cgroup ro,nosuid,nodev,noexec,relatime,cpu,cpuacct <span class=m>0</span> <span class=m>0</span>
</span></span><span class=line><span class=cl>cgroup /sys/fs/cgroup/memory cgroup ro,nosuid,nodev,noexec,relatime,memory <span class=m>0</span> <span class=m>0</span>
</span></span><span class=line><span class=cl>cgroup /sys/fs/cgroup/net_cls,net_prio cgroup ro,nosuid,nodev,noexec,relatime,net_cls,net_prio <span class=m>0</span> <span class=m>0</span>
</span></span><span class=line><span class=cl>cgroup /sys/fs/cgroup/pids cgroup ro,nosuid,nodev,noexec,relatime,pids <span class=m>0</span> <span class=m>0</span>
</span></span><span class=line><span class=cl>cgroup /sys/fs/cgroup/freezer cgroup ro,nosuid,nodev,noexec,relatime,freezer <span class=m>0</span> <span class=m>0</span>
</span></span><span class=line><span class=cl>cgroup /sys/fs/cgroup/cpuset cgroup ro,nosuid,nodev,noexec,relatime,cpuset <span class=m>0</span> <span class=m>0</span>
</span></span><span class=line><span class=cl>cgroup /sys/fs/cgroup/devices cgroup ro,nosuid,nodev,noexec,relatime,devices <span class=m>0</span> <span class=m>0</span>
</span></span><span class=line><span class=cl>cgroup /sys/fs/cgroup/perf_event cgroup ro,nosuid,nodev,noexec,relatime,perf_event <span class=m>0</span> <span class=m>0</span>
</span></span><span class=line><span class=cl>cgroup /sys/fs/cgroup/rdma cgroup ro,nosuid,nodev,noexec,relatime,rdma <span class=m>0</span> <span class=m>0</span>
</span></span><span class=line><span class=cl>cgroup /sys/fs/cgroup/blkio cgroup ro,nosuid,nodev,noexec,relatime,blkio <span class=m>0</span> <span class=m>0</span>
</span></span><span class=line><span class=cl>mqueue /dev/mqueue mqueue rw,nosuid,nodev,noexec,relatime <span class=m>0</span> <span class=m>0</span>
</span></span><span class=line><span class=cl>/dev/sda2 /entrypoint.sh ext4 rw,relatime <span class=m>0</span> <span class=m>0</span>
</span></span><span class=line><span class=cl>/dev/sda2 /etc/resolv.conf ext4 rw,relatime <span class=m>0</span> <span class=m>0</span>
</span></span><span class=line><span class=cl>/dev/sda2 /etc/hostname ext4 rw,relatime <span class=m>0</span> <span class=m>0</span>
</span></span><span class=line><span class=cl>/dev/sda2 /etc/hosts ext4 rw,relatime <span class=m>0</span> <span class=m>0</span>
</span></span><span class=line><span class=cl>shm /dev/shm tmpfs rw,nosuid,nodev,noexec,relatime,size<span class=o>=</span>65536k <span class=m>0</span> <span class=m>0</span>
</span></span><span class=line><span class=cl>proc /proc/bus proc ro,nosuid,nodev,noexec,relatime <span class=m>0</span> <span class=m>0</span>
</span></span><span class=line><span class=cl>proc /proc/fs proc ro,nosuid,nodev,noexec,relatime <span class=m>0</span> <span class=m>0</span>
</span></span><span class=line><span class=cl>proc /proc/irq proc ro,nosuid,nodev,noexec,relatime <span class=m>0</span> <span class=m>0</span>
</span></span><span class=line><span class=cl>proc /proc/sys proc ro,nosuid,nodev,noexec,relatime <span class=m>0</span> <span class=m>0</span>
</span></span><span class=line><span class=cl>proc /proc/sysrq-trigger proc ro,nosuid,nodev,noexec,relatime <span class=m>0</span> <span class=m>0</span>
</span></span><span class=line><span class=cl>tmpfs /proc/acpi tmpfs ro,relatime <span class=m>0</span> <span class=m>0</span>
</span></span><span class=line><span class=cl>tmpfs /proc/kcore tmpfs rw,nosuid,size<span class=o>=</span>65536k,mode<span class=o>=</span><span class=m>755</span> <span class=m>0</span> <span class=m>0</span>
</span></span><span class=line><span class=cl>tmpfs /proc/keys tmpfs rw,nosuid,size<span class=o>=</span>65536k,mode<span class=o>=</span><span class=m>755</span> <span class=m>0</span> <span class=m>0</span>
</span></span><span class=line><span class=cl>tmpfs /proc/timer_list tmpfs rw,nosuid,size<span class=o>=</span>65536k,mode<span class=o>=</span><span class=m>755</span> <span class=m>0</span> <span class=m>0</span>
</span></span><span class=line><span class=cl>tmpfs /proc/sched_debug tmpfs rw,nosuid,size<span class=o>=</span>65536k,mode<span class=o>=</span><span class=m>755</span> <span class=m>0</span> <span class=m>0</span>
</span></span><span class=line><span class=cl>tmpfs /proc/scsi tmpfs ro,relatime <span class=m>0</span> <span class=m>0</span>
</span></span><span class=line><span class=cl>tmpfs /sys/firmware tmpfs ro,relatime <span class=m>0</span> <span class=m>0</span>
</span></span></code></pre></div><p>I created a file test inside the docker and it could be seen from the host machine. The rest steps are quite simple putting the bash SUID binary inside the temporary directory and getting root in the host machine.</p><p><img alt=Untitled loading=lazy src=/posts/monitorstwo/MonitorsTwo%20f8837d236f27423191390fe94e30a78b/Untitled%209.png></p><p><img alt=Untitled loading=lazy src=/posts/monitorstwo/MonitorsTwo%20f8837d236f27423191390fe94e30a78b/Untitled%2010.png></p><p><img alt=Untitled loading=lazy src=/posts/monitorstwo/MonitorsTwo%20f8837d236f27423191390fe94e30a78b/Untitled%2011.png></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>noob-5.1# ls -la
</span></span><span class=line><span class=cl>total <span class=m>28</span>
</span></span><span class=line><span class=cl>drwx-----x  <span class=m>5</span> root root <span class=m>4096</span> Sep  <span class=m>1</span> 05:11 .
</span></span><span class=line><span class=cl>drwx-----x <span class=m>37</span> root root <span class=m>4096</span> Sep  <span class=m>1</span> 05:11 ..
</span></span><span class=line><span class=cl>drwxr-xr-x  <span class=m>7</span> root root <span class=m>4096</span> Sep  <span class=m>1</span> 09:24 diff
</span></span><span class=line><span class=cl>-rw-r--r--  <span class=m>1</span> root root   <span class=m>26</span> Mar <span class=m>21</span> 10:49 link
</span></span><span class=line><span class=cl>-rw-r--r--  <span class=m>1</span> root root  <span class=m>579</span> Mar <span class=m>21</span> 10:49 lower
</span></span><span class=line><span class=cl>drwxr-xr-x  <span class=m>1</span> root root <span class=m>4096</span> Sep  <span class=m>1</span> 09:24 merged
</span></span><span class=line><span class=cl>drwx------  <span class=m>3</span> root root <span class=m>4096</span> Sep  <span class=m>1</span> 05:11 work
</span></span><span class=line><span class=cl>noob-5.1# <span class=nb>pwd</span>
</span></span><span class=line><span class=cl>/var/lib/docker/overlay2/c41d5854e43bd996e128d647cb526b73d04c9ad6325201c85f73fdba372cb2f1
</span></span><span class=line><span class=cl>noob-5.1# ls -la merged
</span></span><span class=line><span class=cl>total <span class=m>152</span>
</span></span><span class=line><span class=cl>drwxr-xr-x <span class=m>1</span> root root  <span class=m>4096</span> Sep  <span class=m>1</span> 09:24 .
</span></span><span class=line><span class=cl>drwx-----x <span class=m>5</span> root root  <span class=m>4096</span> Sep  <span class=m>1</span> 05:11 ..
</span></span><span class=line><span class=cl>drwxr-xr-x <span class=m>1</span> root root  <span class=m>4096</span> Mar <span class=m>22</span> 13:21 bin
</span></span><span class=line><span class=cl>drwxr-xr-x <span class=m>2</span> root root  <span class=m>4096</span> Mar <span class=m>22</span> 13:21 boot
</span></span><span class=line><span class=cl>drwxr-xr-x <span class=m>1</span> root root  <span class=m>4096</span> Mar <span class=m>21</span> 10:49 dev
</span></span><span class=line><span class=cl>-rwxr-xr-x <span class=m>1</span> root root     <span class=m>0</span> Mar <span class=m>21</span> 10:49 .dockerenv
</span></span><span class=line><span class=cl>-rwxr-xr-x <span class=m>1</span> root root     <span class=m>0</span> Jan  <span class=m>5</span>  <span class=m>2023</span> entrypoint.sh
</span></span><span class=line><span class=cl>drwxr-xr-x <span class=m>1</span> root root  <span class=m>4096</span> Mar <span class=m>21</span> 10:49 etc
</span></span><span class=line><span class=cl>drwxr-xr-x <span class=m>2</span> root root  <span class=m>4096</span> Mar <span class=m>22</span> 13:21 home
</span></span><span class=line><span class=cl>drwxr-xr-x <span class=m>1</span> root root  <span class=m>4096</span> Nov <span class=m>15</span>  <span class=m>2022</span> lib
</span></span><span class=line><span class=cl>drwxr-xr-x <span class=m>2</span> root root  <span class=m>4096</span> Mar <span class=m>22</span> 13:21 lib64
</span></span><span class=line><span class=cl>drwxr-xr-x <span class=m>2</span> root root  <span class=m>4096</span> Mar <span class=m>22</span> 13:21 media
</span></span><span class=line><span class=cl>drwxr-xr-x <span class=m>2</span> root root  <span class=m>4096</span> Mar <span class=m>22</span> 13:21 mnt
</span></span><span class=line><span class=cl>drwxr-xr-x <span class=m>2</span> root root  <span class=m>4096</span> Mar <span class=m>22</span> 13:21 opt
</span></span><span class=line><span class=cl>drwxr-xr-x <span class=m>2</span> root root  <span class=m>4096</span> Mar <span class=m>22</span> 13:21 proc
</span></span><span class=line><span class=cl>drwx------ <span class=m>1</span> root root  <span class=m>4096</span> Mar <span class=m>21</span> 10:50 root
</span></span><span class=line><span class=cl>drwxr-xr-x <span class=m>1</span> root root  <span class=m>4096</span> Nov <span class=m>15</span>  <span class=m>2022</span> run
</span></span><span class=line><span class=cl>drwxr-xr-x <span class=m>1</span> root root  <span class=m>4096</span> Jan  <span class=m>9</span>  <span class=m>2023</span> sbin
</span></span><span class=line><span class=cl>drwxr-xr-x <span class=m>2</span> root root  <span class=m>4096</span> Mar <span class=m>22</span> 13:21 srv
</span></span><span class=line><span class=cl>drwxr-xr-x <span class=m>2</span> root root  <span class=m>4096</span> Mar <span class=m>22</span> 13:21 sys
</span></span><span class=line><span class=cl>drwxrwxrwt <span class=m>1</span> root root <span class=m>57344</span> Sep  <span class=m>1</span> 09:37 tmp
</span></span><span class=line><span class=cl>drwxr-xr-x <span class=m>1</span> root root  <span class=m>4096</span> Nov <span class=m>14</span>  <span class=m>2022</span> usr
</span></span><span class=line><span class=cl>drwxr-xr-x <span class=m>1</span> root root  <span class=m>4096</span> Nov <span class=m>15</span>  <span class=m>2022</span> var
</span></span><span class=line><span class=cl>noob-5.1# ls -la diff
</span></span><span class=line><span class=cl>total <span class=m>96</span>
</span></span><span class=line><span class=cl>drwxr-xr-x <span class=m>7</span> root root  <span class=m>4096</span> Sep  <span class=m>1</span> 09:24 .
</span></span><span class=line><span class=cl>drwx-----x <span class=m>5</span> root root  <span class=m>4096</span> Sep  <span class=m>1</span> 05:11 ..
</span></span><span class=line><span class=cl>drwxr-xr-x <span class=m>2</span> root root  <span class=m>4096</span> Mar <span class=m>22</span> 13:21 bin
</span></span><span class=line><span class=cl>drwx------ <span class=m>2</span> root root  <span class=m>4096</span> Mar <span class=m>21</span> 10:50 root
</span></span><span class=line><span class=cl>drwxr-xr-x <span class=m>3</span> root root  <span class=m>4096</span> Nov <span class=m>15</span>  <span class=m>2022</span> run
</span></span><span class=line><span class=cl>drwxrwxrwt <span class=m>2</span> root root <span class=m>57344</span> Sep  <span class=m>1</span> 09:37 tmp
</span></span><span class=line><span class=cl>drwxr-xr-x <span class=m>4</span> root root  <span class=m>4096</span> Nov <span class=m>15</span>  <span class=m>2022</span> var
</span></span></code></pre></div><h3 id=references>References<a hidden class=anchor aria-hidden=true href=#references>#</a></h3><p><a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-41091">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-41091</a></p><p><a href=https://nvd.nist.gov/vuln/detail/CVE-2022-46169>https://nvd.nist.gov/vuln/detail/CVE-2022-46169</a></p></div><footer class=post-footer><ul class=post-tags><li><a href=//localhost:1313/tags/linux/>Linux</a></li><li><a href=//localhost:1313/tags/cacti/>Cacti</a></li><li><a href=//localhost:1313/tags/docker/>Docker</a></li><li><a href=//localhost:1313/tags/suid/>Suid</a></li></ul><nav class=paginav><a class=prev href=//localhost:1313/posts/pilgrimage/><span class=title>« Prev</span><br><span>A Pilgrim's Progress: Exploiting ImageMagick and Binwalk on Pilgrimage</span>
</a><a class=next href=//localhost:1313/posts/metatwo/><span class=title>Next »</span><br><span>Beyond the Blog: Exploiting WordPress CVEs on HTB 'MetaTwo'</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share Abusing Cacti: From SQLi to Root on MonitorsTwo on x" href="https://x.com/intent/tweet/?text=Abusing%20Cacti%3a%20From%20SQLi%20to%20Root%20on%20MonitorsTwo&amp;url=%2f%2flocalhost%3a1313%2fposts%2fmonitorstwo%2f&amp;hashtags=linux%2ccacti%2cdocker%2csuid"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Abusing Cacti: From SQLi to Root on MonitorsTwo on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=%2f%2flocalhost%3a1313%2fposts%2fmonitorstwo%2f&amp;title=Abusing%20Cacti%3a%20From%20SQLi%20to%20Root%20on%20MonitorsTwo&amp;summary=Abusing%20Cacti%3a%20From%20SQLi%20to%20Root%20on%20MonitorsTwo&amp;source=%2f%2flocalhost%3a1313%2fposts%2fmonitorstwo%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Abusing Cacti: From SQLi to Root on MonitorsTwo on reddit" href="https://reddit.com/submit?url=%2f%2flocalhost%3a1313%2fposts%2fmonitorstwo%2f&title=Abusing%20Cacti%3a%20From%20SQLi%20to%20Root%20on%20MonitorsTwo"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Abusing Cacti: From SQLi to Root on MonitorsTwo on facebook" href="https://facebook.com/sharer/sharer.php?u=%2f%2flocalhost%3a1313%2fposts%2fmonitorstwo%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Abusing Cacti: From SQLi to Root on MonitorsTwo on whatsapp" href="https://api.whatsapp.com/send?text=Abusing%20Cacti%3a%20From%20SQLi%20to%20Root%20on%20MonitorsTwo%20-%20%2f%2flocalhost%3a1313%2fposts%2fmonitorstwo%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Abusing Cacti: From SQLi to Root on MonitorsTwo on telegram" href="https://telegram.me/share/url?text=Abusing%20Cacti%3a%20From%20SQLi%20to%20Root%20on%20MonitorsTwo&amp;url=%2f%2flocalhost%3a1313%2fposts%2fmonitorstwo%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentColor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Abusing Cacti: From SQLi to Root on MonitorsTwo on ycombinator" href="https://news.ycombinator.com/submitlink?t=Abusing%20Cacti%3a%20From%20SQLi%20to%20Root%20on%20MonitorsTwo&u=%2f%2flocalhost%3a1313%2fposts%2fmonitorstwo%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></li></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=//localhost:1313/>Fieryrival's Blog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");if(menu){const e=localStorage.getItem("menu-scroll-position");e&&(menu.scrollLeft=parseInt(e,10)),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}}document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{const e=document.querySelector("html");e.dataset.theme==="dark"?(e.dataset.theme="light",localStorage.setItem("pref-theme","light")):(e.dataset.theme="dark",localStorage.setItem("pref-theme","dark"))})</script></body></html>